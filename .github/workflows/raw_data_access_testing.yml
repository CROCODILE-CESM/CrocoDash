name: Check Raw Dataset Access

on:
  schedule:
    - cron: '0 0 * * *'  # Runs daily at midnight UTC
  workflow_dispatch:  # Allows manual triggering


jobs:
  check-links:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
            submodules: recursive
      - uses: conda-incubator/setup-miniconda@v3
        with:
          activate-environment: CrocoDash
          environment-file: environment.yml  
      - name: Run link checker
        run: |
          source $(conda info --base)/etc/profile.d/conda.sh 
          conda activate CrocoDash 
          python tests/check_raw_data.py
      - name: Upload report to GitHub Pages
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_branch: gh-pages
          publish_dir: docs/source/_static  # Or wherever the HTML is saved
          destination_dir: reports  # Uploads to gh-pages/reports/
          keep_files: true  # âœ¨ Important: keeps existing docs intact
